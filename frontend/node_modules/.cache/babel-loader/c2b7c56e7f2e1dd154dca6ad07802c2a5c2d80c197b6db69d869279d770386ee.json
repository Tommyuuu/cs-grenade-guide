{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport axios from \"axios\";\nimport NavBar from '@/components/NavBar.vue';\nexport default {\n  components: {\n    NavBar\n  },\n  name: \"AdminView\",\n  data() {\n    return {\n      pendingList: [],\n      selected: null,\n      page: 1,\n      pageSize: 10,\n      total: 0,\n      videoUrl: ''\n    };\n  },\n  created() {\n    this.fetchPending();\n  },\n  methods: {\n    fetchPending() {\n      axios.get(`http://127.0.0.1:5000/pending_methods_paginated?page=${this.page}&size=${this.pageSize}`).then(res => {\n        this.pendingList = res.data.data;\n        this.total = res.data.total;\n      });\n    },\n    nextPage() {\n      if (this.page * this.pageSize < this.total) {\n        this.page++;\n        this.fetchPending();\n      }\n    },\n    prevPage() {\n      if (this.page > 1) {\n        this.page--;\n        this.fetchPending();\n      }\n    },\n    selectItem(name) {\n      axios.get(`http://127.0.0.1:5000/get_single_pending/${name}`).then(res => {\n        this.videoUrl = res.data.method.video_url;\n        this.selected = res.data;\n      }).catch(err => {\n        console.error('無法取得影片資訊：', err);\n      });\n    },\n    approve(id) {\n      axios.post(`http://127.0.0.1:5000/approve/${id}`).then(() => {\n        this.fetchPending();\n        this.removeItem(id);\n      });\n    },\n    reject(id) {\n      axios.post(`http://127.0.0.1:5000/reject/${id}`).then(() => {\n        this.fetchPending();\n        this.removeItem(id);\n      });\n    },\n    removeItem(id) {\n      this.pendingList = this.pendingList.filter(item => item.id !== id);\n      this.selected = null;\n    },\n    isYoutube(url) {\n      return url.includes('youtube.com') || url.includes('youtu.be');\n    },\n    embedYoutube(url) {\n      if (url.includes('/shorts/')) {\n        const id = url.split('/shorts/')[1].split('?')[0];\n        return `https://www.youtube.com/embed/${id}`;\n      } else if (url.includes('watch?v=')) {\n        const id = url.split('watch?v=')[1].split('&')[0];\n        return `https://www.youtube.com/embed/${id}`;\n      } else if (url.includes('youtu.be/')) {\n        const id = url.split('youtu.be/')[1].split('?')[0];\n        return `https://www.youtube.com/embed/${id}`;\n      } else {\n        return ''; // 無效網址處理\n      }\n    }\n  }\n};","map":{"version":3,"names":["axios","NavBar","components","name","data","pendingList","selected","page","pageSize","total","videoUrl","created","fetchPending","methods","get","then","res","nextPage","prevPage","selectItem","method","video_url","catch","err","console","error","approve","id","post","removeItem","reject","filter","item","isYoutube","url","includes","embedYoutube","split"],"sources":["C:\\Users\\tangchi\\OneDrive\\桌面\\Code\\sidep\\frontend\\src\\views\\AdminView.vue"],"sourcesContent":["<template>\r\n  <NavBar title=\"待審核投擲教學\" />\r\n\r\n  <div class=\"detail-wrapper\"> <!-- ✅ 包整頁，置中所有內容 -->\r\n\r\n    <!-- 若無資料 -->\r\n    <div v-if=\"pendingList.length === 0\">目前沒有待審核的資料</div>\r\n\r\n    <!-- 表格列表 -->\r\n    <table v-else class=\"pending-table\">\r\n      <thead>\r\n        <tr>\r\n          <th>#</th>\r\n          <th>地圖</th>\r\n          <th>道具</th>\r\n          <th>點位</th>\r\n          <th>方法名稱</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr\r\n          v-for=\"(item, index) in pendingList\"\r\n          :key=\"item.id\"\r\n          @click=\"selectItem(item.method.name)\"\r\n          class=\"table-row\"\r\n        >\r\n          <td>{{ (page - 1) * pageSize + index + 1 }}</td>\r\n          <td>{{ item.map }}</td>\r\n          <td>{{ item.grenade_type }}</td>\r\n          <td>{{ item.point_name }}</td>\r\n          <td>\r\n            <a href=\"#\" @click.prevent=\"selectItem(item.method.name)\">{{ item.method.name }}</a>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n\r\n    <!-- 分頁按鈕 -->\r\n    <div class=\"pagination-controls\">\r\n      <button @click=\"prevPage\" :disabled=\"page === 1\">上一頁</button>\r\n      <span>第 {{ page }} 頁</span>\r\n      <button @click=\"nextPage\" :disabled=\"page * pageSize >= total\">下一頁</button>\r\n    </div>\r\n\r\n    <!-- 🔽 左右並排容器 -->\r\n    <div v-if=\"selected\" class=\"preview-flex\">\r\n        <!-- 左側：影片預覽 -->\r\n        <div class=\"video-section\">\r\n            <h3>影片預覽：</h3>\r\n            <div v-if=\"isYoutube(videoUrl)\">\r\n                <iframe\r\n                    width=\"1080\"\r\n                    height=\"720\"\r\n                    :src=\"embedYoutube(videoUrl)\"\r\n                    frameborder=\"0\"\r\n                    allowfullscreen\r\n                ></iframe>\r\n            </div>\r\n            <div v-else-if=\"videoUrl\">\r\n                <video :src=\"videoUrl\" controls width=\"400\" />\r\n            </div>\r\n        </div>\r\n\r\n        <!-- 右側：地圖與紅點 -->\r\n        <div class=\"map-section\">\r\n            <h4>地圖與丟點預覽：</h4>\r\n            <div class=\"map-preview\">\r\n                <img \r\n                    :src=\"`/maps/${selected.map.toLowerCase()}.png`\" alt=\"map\" />\r\n                <div\r\n                    class=\"red-dot\"\r\n                    :style=\"{ left: selected.x + 'px', top: selected.y + 'px' }\"\r\n                ></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <div v-if=\"selected\">\r\n        <div class=\"info-block\">\r\n            <p><strong>地圖：</strong>{{ selected.map }}</p>\r\n            <p><strong>道具：</strong>{{ selected.grenade_type }}</p>\r\n            <p><strong>點位：</strong>{{ selected.point_name }}</p>\r\n            <p><strong>方法名稱：</strong>{{ selected.method.name }}</p>\r\n\r\n            <div class=\"actions\">\r\n                <button @click=\"approve(selected.id)\">✅ 同意</button>\r\n                <button @click=\"reject(selected.id)\">❌ 拒絕</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n  </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport NavBar from '@/components/NavBar.vue'\r\nexport default {\r\n  components: { NavBar },\r\n  name: \"AdminView\",\r\n  data() {\r\n    return {\r\n      pendingList: [],\r\n      selected: null,\r\n      page: 1,\r\n      pageSize: 10,\r\n      total: 0,\r\n      videoUrl: '',\r\n    };\r\n  },\r\n  created() {\r\n    this.fetchPending();\r\n  },\r\n  methods: {\r\n    fetchPending() {\r\n      axios.get(`http://127.0.0.1:5000/pending_methods_paginated?page=${this.page}&size=${this.pageSize}`)\r\n        .then(res => {\r\n            this.pendingList = res.data.data;\r\n            this.total = res.data.total;\r\n        });\r\n    },\r\n    nextPage() {\r\n        if (this.page * this.pageSize < this.total) {\r\n            this.page++;\r\n            this.fetchPending();\r\n        }\r\n    },\r\n\r\n    prevPage() {\r\n        if (this.page > 1) {\r\n            this.page--;\r\n            this.fetchPending();\r\n        }\r\n    },\r\n\r\n    selectItem(name) {\r\n      axios.get(`http://127.0.0.1:5000/get_single_pending/${name}`)\r\n        .then(res => {\r\n            this.videoUrl=res.data.method.video_url;\r\n            this.selected = res.data;\r\n\r\n        })\r\n        .catch(err => {\r\n            console.error('無法取得影片資訊：', err);\r\n        });\r\n    },\r\n    approve(id) {\r\n      axios.post(`http://127.0.0.1:5000/approve/${id}`)\r\n        .then(() => {\r\n          this.fetchPending();  \r\n          this.removeItem(id);\r\n        });\r\n    },\r\n    reject(id) {\r\n      axios.post(`http://127.0.0.1:5000/reject/${id}`)\r\n        .then(() => {\r\n          this.fetchPending();  \r\n          this.removeItem(id);\r\n        });\r\n    },\r\n    removeItem(id) {\r\n      this.pendingList = this.pendingList.filter(item => item.id !== id);\r\n      this.selected = null;\r\n    },\r\n    isYoutube(url) {\r\n        return url.includes('youtube.com') || url.includes('youtu.be');\r\n    },\r\n    embedYoutube(url) {\r\n        if (url.includes('/shorts/')) {\r\n        const id = url.split('/shorts/')[1].split('?')[0];\r\n        return `https://www.youtube.com/embed/${id}`;\r\n        } else if (url.includes('watch?v=')) {\r\n        const id = url.split('watch?v=')[1].split('&')[0];\r\n        return `https://www.youtube.com/embed/${id}`;\r\n        } else if (url.includes('youtu.be/')) {\r\n        const id = url.split('youtu.be/')[1].split('?')[0];\r\n        return `https://www.youtube.com/embed/${id}`;\r\n        } else {\r\n        return ''; // 無效網址處理\r\n        }\r\n    },\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.detail-wrapper {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  text-align: center;\r\n  margin-top: 30px;\r\n}\r\n\r\n.pending-table {\r\n  width: 90%;\r\n  border-collapse: collapse;\r\n  margin-bottom: 20px;\r\n  text-align: center;\r\n}\r\n\r\n.pending-table th,\r\n.pending-table td {\r\n  border: 1px solid #ccc;\r\n  padding: 12px 16px;\r\n}\r\n\r\n.pending-table th {\r\n  background-color: #f9f9f9;\r\n}\r\n\r\n.pagination-controls {\r\n  margin-bottom: 30px;\r\n}\r\n\r\n.info-block {\r\n  margin-top: 20px;\r\n  font-size: 16px;\r\n  line-height: 1.8;\r\n}\r\n\r\n.actions {\r\n  margin-top: 12px;\r\n}\r\n\r\n.actions button {\r\n  margin: 0 10px;\r\n  padding: 6px 12px;\r\n  font-size: 14px;\r\n}\r\n\r\n.preview-flex {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: flex-start;\r\n  gap: 40px;\r\n  margin-top: 20px;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.video-section, .map-section {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n}\r\n\r\n.map-preview {\r\n  position: relative;\r\n  width: 800px;\r\n  /*height: 500px;*/\r\n  border: 2px solid #05597f;\r\n}\r\n\r\n.map-preview img {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: contain;\r\n}\r\n\r\n.red-dot {\r\n  position: absolute;\r\n  width: 16px;\r\n  height: 16px;\r\n  background-color: red;\r\n  border-radius: 50%;\r\n  transform: translate(-50%, -50%);\r\n  border: 2px solid black;\r\n}\r\n\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}