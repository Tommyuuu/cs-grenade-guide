(function(){"use strict";var e={2323:function(e,t,s){var o=s(3751),n=s(641);function l(e,t,s,o,l,a){const i=(0,n.g2)("router-view");return(0,n.uX)(),(0,n.Wv)(i)}var a={name:"App"},i=s(6262);const d=(0,i.A)(a,[["render",l]]);var r=d,c=s(5220),u=s(33);const m={class:"esports-bg text-white min-vh-100 py-5"},h={class:"container py-4 text-white esports-bg position-relative"},p={class:"card esports-card p-3 bg-dark mb-4 position-relative"},b={class:"d-flex justify-content-between align-items-center flex-wrap gap-2 mb-3"},g={class:"d-flex align-items-center"},k={class:"d-flex gap-2"},v={class:"position-relative mx-auto",style:{"max-width":"800px"}},w=["src"],L=["onClick","title"],f=["title"],y={key:0,class:"position-fixed top-50 start-50 translate-middle bg-dark text-white p-4 rounded shadow-lg"},C={class:"d-flex justify-content-between align-items-center mb-3"},x={class:"d-flex gap-2"},P={key:1,class:"position-fixed top-50 start-50 translate-middle bg-dark text-white p-4 rounded shadow-lg"},_={class:"d-flex justify-content-between align-items-center mb-3"},M={class:"text-info"},A={class:"d-flex gap-2"},U={key:2,class:"position-fixed top-50 start-50 translate-middle bg-dark text-white p-4 rounded shadow-lg",style:{"z-index":"1050","min-width":"300px"}},E={class:"d-flex justify-content-between align-items-center mb-3"},N={class:"text-info mb-0"},X=["value"],F={key:3,class:"card bg-dark text-white p-3 mb-4"},S={class:"ratio ratio-16x9"},$=["src"],I=["src"];function T(e,t,s,l,a,i){const d=(0,n.g2)("NavBar"),r=(0,n.g2)("ChatRoom");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(d,{title:`${s.mapName} - 道具教學`},null,8,["title"]),(0,n.Lk)("div",m,[(0,n.Lk)("div",h,[(0,n.Lk)("div",p,[(0,n.Lk)("div",b,[(0,n.Lk)("div",g,[t[21]||(t[21]=(0,n.Lk)("label",{for:"grenadeSelect",class:"form-label text-light me-2 mb-0"},"選擇道具：",-1)),(0,n.bo)((0,n.Lk)("select",{id:"grenadeSelect",class:"form-select bg-dark text-light border-secondary w-auto","onUpdate:modelValue":t[0]||(t[0]=e=>a.selectedGrenade=e)},[t[20]||(t[20]=(0,n.Lk)("option",{disabled:"",value:""},"請選擇道具",-1)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.grenadeTypes,(e=>((0,n.uX)(),(0,n.CE)("option",{key:e},(0,u.v_)(e),1)))),128))],512),[[o.u1,a.selectedGrenade]])]),(0,n.Lk)("div",k,[a.selectedGrenade&&i.account_session?((0,n.uX)(),(0,n.CE)("button",{key:0,class:(0,u.C4)(["btn btn-outline-info",{active:a.isAddP}]),onClick:t[1]||(t[1]=e=>{a.isAddP=!0,a.selectedMethodPanelVisible=!1,a.showAddForm=!1})},"➕ 新增點位丟法 ",2)):(0,n.Q3)("",!0),a.selectedPoint&&i.account_session?((0,n.uX)(),(0,n.CE)("button",{key:1,class:(0,u.C4)(["btn btn-outline-warning",{active:a.showAddForm}]),onClick:t[2]||(t[2]=e=>{a.showAddForm=!0,a.selectedMethodPanelVisible=!1,a.isAddP=!1})}," ➕ 新增丟法 ",2)):(0,n.Q3)("",!0)])]),(0,n.Lk)("div",v,[(0,n.Lk)("img",{src:`/maps/${s.mapName.toLowerCase()}.png`,class:"img-fluid",onClick:t[3]||(t[3]=(...e)=>i.MapClick&&i.MapClick(...e))},null,8,w),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.points,((e,t)=>((0,n.uX)(),(0,n.CE)("button",{key:t,class:(0,u.C4)(["btn btn-info position-absolute translate-middle marker",{active:a.selectedPoint?.name===e.name}]),style:(0,u.Tr)({left:e.x+"px",top:e.y+"px"}),onClick:t=>i.selectUsagePoint(e),title:e.name},"📍",14,L)))),128)),a.tempxy&&void 0!==a.tempxy.x&&void 0!==a.tempxy.y?((0,n.uX)(),(0,n.CE)("button",{key:0,class:"position-absolute translate-middle marker-temp",style:(0,u.Tr)({left:a.tempxy.x+"px",top:a.tempxy.y+"px"}),title:e.暫存點,disabled:""},"📌",12,f)):(0,n.Q3)("",!0)])]),a.showAddPForm&&void 0!==a.tempxy.x?((0,n.uX)(),(0,n.CE)("div",y,[(0,n.Lk)("div",C,[t[22]||(t[22]=(0,n.Lk)("h5",{class:"text-info"},"新增點位丟法",-1)),(0,n.Lk)("button",{class:"btn-close btn-close-white",onClick:t[4]||(t[4]=e=>a.showAddPForm=!1)})]),(0,n.bo)((0,n.Lk)("input",{class:"form-control mb-2","onUpdate:modelValue":t[5]||(t[5]=t=>e.newPostionName=t),placeholder:"點位名稱"},null,512),[[o.Jo,e.newPostionName]]),(0,n.bo)((0,n.Lk)("input",{class:"form-control mb-2","onUpdate:modelValue":t[6]||(t[6]=e=>a.newMethodName=e),placeholder:"丟法名稱"},null,512),[[o.Jo,a.newMethodName]]),(0,n.bo)((0,n.Lk)("input",{class:"form-control mb-2","onUpdate:modelValue":t[7]||(t[7]=e=>a.newMethodURL=e),placeholder:"影片網址"},null,512),[[o.Jo,a.newMethodURL]]),(0,n.Lk)("div",x,[(0,n.Lk)("button",{class:"btn btn-success",onClick:t[8]||(t[8]=e=>i.submitNewPostionMethod())},"送出"),(0,n.Lk)("button",{class:"btn btn-secondary",onClick:t[9]||(t[9]=e=>i.cancel_npm())},"取消")])])):(0,n.Q3)("",!0),a.showAddForm?((0,n.uX)(),(0,n.CE)("div",P,[(0,n.Lk)("div",_,[(0,n.Lk)("h5",M,"新增丟法："+(0,u.v_)(a.selectedPoint.name),1),(0,n.Lk)("button",{class:"btn-close btn-close-white",onClick:t[10]||(t[10]=e=>a.showAddForm=!1)})]),(0,n.bo)((0,n.Lk)("input",{class:"form-control mb-2","onUpdate:modelValue":t[11]||(t[11]=e=>a.newMethodName=e),placeholder:"丟法名稱"},null,512),[[o.Jo,a.newMethodName]]),(0,n.bo)((0,n.Lk)("input",{class:"form-control mb-2","onUpdate:modelValue":t[12]||(t[12]=e=>a.newMethodURL=e),placeholder:"影片網址"},null,512),[[o.Jo,a.newMethodURL]]),(0,n.Lk)("div",A,[(0,n.Lk)("button",{class:"btn btn-success",onClick:t[13]||(t[13]=(...e)=>i.submitNewMethod&&i.submitNewMethod(...e))},"送出"),(0,n.Lk)("button",{class:"btn btn-secondary",onClick:t[14]||(t[14]=e=>a.showAddForm=!1)},"取消")])])):(0,n.Q3)("",!0),a.selectedPoint&&a.selectedPoint.methods.length>1&&a.selectedMethodPanelVisible?((0,n.uX)(),(0,n.CE)("div",U,[(0,n.Lk)("div",E,[(0,n.Lk)("h5",N,"選擇丟法："+(0,u.v_)(a.selectedPoint.name),1),(0,n.Lk)("button",{class:"btn-close btn-close-white",onClick:t[15]||(t[15]=e=>a.selectedMethodPanelVisible=!1)})]),(0,n.bo)((0,n.Lk)("select",{class:"form-select","onUpdate:modelValue":t[16]||(t[16]=e=>a.selectedMethod=e),onChange:t[17]||(t[17]=(...e)=>i.fetchVideoFromPoint&&i.fetchVideoFromPoint(...e))},[t[23]||(t[23]=(0,n.Lk)("option",{disabled:"",value:""},"請選擇丟法",-1)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.selectedPoint.methods,(e=>((0,n.uX)(),(0,n.CE)("option",{key:e.name,value:e.video_url},(0,u.v_)(e.name),9,X)))),128))],544),[[o.u1,a.selectedMethod]])])):(0,n.Q3)("",!0),a.videoUrl?((0,n.uX)(),(0,n.CE)("div",F,[t[24]||(t[24]=(0,n.Lk)("h5",{class:"text-info mb-3"},"🎮 影片播放",-1)),(0,n.Lk)("div",S,[a.videoUrl.includes("youtube")?((0,n.uX)(),(0,n.CE)("iframe",{key:0,src:i.embedYoutube(a.videoUrl),allowfullscreen:""},null,8,$)):((0,n.uX)(),(0,n.CE)("video",{key:1,class:"w-100",controls:"",src:a.videoUrl},null,8,I))])])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",null,[a.showChat?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("button",{key:0,class:"btn btn-secondary position-fixed bottom-0 end-0 m-3 z-3",onClick:t[18]||(t[18]=e=>a.showChat=!0)}," 顯示聊天室 ")),a.showChat?((0,n.uX)(),(0,n.Wv)(r,{key:1,mapName:s.mapName,username:i.username,onClose:t[19]||(t[19]=e=>a.showChat=!1)},null,8,["mapName","username"])):(0,n.Q3)("",!0)])])],64)}const j={class:"navbar bg-dark border-bottom border-body","data-bs-theme":"dark"},V={class:"container-fluid"},R={class:"navbar-brand fw-bold fs-5 fst-italic text-warning",href:"#"},Q={class:"d-flex align-items-center"},K={class:"text-info me-3"};function B(e,t,s,o,l,a){const i=(0,n.g2)("LoginModal"),d=(0,n.g2)("SignUp");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("nav",j,[(0,n.Lk)("div",V,[(0,n.Lk)("span",R,(0,u.v_)(s.title),1),t[5]||(t[5]=(0,n.Lk)("ul",{class:"navbar-nav me-auto mb-2 mb-lg-0"},[(0,n.Lk)("li",{class:"nav-item"},[(0,n.Lk)("a",{class:"nav-link active","aria-current":"page",href:"/"}," 首頁")])],-1)),(0,n.Lk)("div",Q,[o.userStore.isLoggedIn?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[(0,n.Lk)("span",K,"👤 "+(0,u.v_)(o.userStore.username),1),(0,n.Lk)("button",{class:"btn btn-outline-light btn-sm",onClick:t[0]||(t[0]=(...e)=>o.logout&&o.logout(...e))},"登出")],64)):((0,n.uX)(),(0,n.CE)(n.FK,{key:1},[(0,n.Lk)("button",{class:"btn btn-warning btn-sm",onClick:t[1]||(t[1]=e=>o.showSignUp=!0)},"註冊"),(0,n.Lk)("button",{class:"btn btn-outline-light btn-sm",onClick:t[2]||(t[2]=e=>o.showLogin=!0)},"登入")],64))])])]),(0,n.bF)(i,{show:o.showLogin,onClose:t[3]||(t[3]=e=>o.showLogin=!1),onLogin:o.handleLogin},null,8,["show","onLogin"]),(0,n.bF)(d,{show:o.showSignUp,onClose:t[4]||(t[4]=e=>o.showSignUp=!1),onSignup:o.handleSignUp},null,8,["show","onSignup"])],64)}s(4114);var O=s(810);const J=(0,O.nY)("user",{state:()=>({username:"",isLoggedIn:!1,role:""}),actions:{login(e,t){this.username=e,this.role=t,this.isLoggedIn=!0},logout(){this.username="",this.role="",this.isLoggedIn=!1}},persist:!0}),Y={key:0,class:"modal fade show d-block",tabindex:"-1",style:{background:"rgba(0, 0, 0, 0.5)"}},z={class:"modal-dialog modal-dialog-centered"},G={class:"modal-content"},W={class:"modal-header"},D={class:"modal-body"},q={class:"mb-3"},H={class:"mb-3"},Z={key:0,class:"alert alert-danger"},ee={class:"d-grid gap-2"};function te(e,t,s,l,a,i){return s.show?((0,n.uX)(),(0,n.CE)("div",Y,[(0,n.Lk)("div",z,[(0,n.Lk)("div",G,[(0,n.Lk)("div",W,[t[5]||(t[5]=(0,n.Lk)("h5",{class:"modal-title"},"登入",-1)),(0,n.Lk)("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=t=>e.$emit("close"))})]),(0,n.Lk)("div",D,[(0,n.Lk)("div",q,[t[6]||(t[6]=(0,n.Lk)("label",{class:"form-label"},"帳號",-1)),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>a.username=e),type:"text",class:"form-control",placeholder:"請輸入帳號"},null,512),[[o.Jo,a.username]])]),(0,n.Lk)("div",H,[t[7]||(t[7]=(0,n.Lk)("label",{class:"form-label"},"密碼",-1)),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>a.password=e),type:"password",class:"form-control",placeholder:"請輸入密碼"},null,512),[[o.Jo,a.password]])]),a.error?((0,n.uX)(),(0,n.CE)("div",Z,(0,u.v_)(a.error),1)):(0,n.Q3)("",!0),(0,n.Lk)("div",ee,[(0,n.Lk)("button",{class:"btn btn-primary",onClick:t[3]||(t[3]=(...e)=>i.login&&i.login(...e))},"登入"),(0,n.Lk)("button",{class:"btn btn-secondary",onClick:t[4]||(t[4]=t=>e.$emit("close"))},"取消")])])])])])):(0,n.Q3)("",!0)}var se={props:["show"],data(){return{username:"",password:"",error:""}},methods:{login(){this.username&&this.password?(this.error="",this.$emit("login",{username:this.username,password:this.password})):this.error="請填寫帳號與密碼"}}};const oe=(0,i.A)(se,[["render",te],["__scopeId","data-v-00e4d90d"]]);var ne=oe,le=s(953),ae=s(4335);const ie={key:0,class:"modal fade show d-block",tabindex:"-1",style:{background:"rgba(0, 0, 0, 0.5)"}},de={class:"modal-dialog modal-dialog-centered"},re={class:"modal-content"},ce={class:"modal-header"},ue={class:"modal-body"},me={class:"mb-3"},he={class:"mb-3"},pe={key:0,class:"alert alert-danger"},be={class:"d-grid gap-2"};function ge(e,t,s,l,a,i){return s.show?((0,n.uX)(),(0,n.CE)("div",ie,[(0,n.Lk)("div",de,[(0,n.Lk)("div",re,[(0,n.Lk)("div",ce,[t[5]||(t[5]=(0,n.Lk)("h5",{class:"modal-title"},"註冊",-1)),(0,n.Lk)("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=t=>e.$emit("close"))})]),(0,n.Lk)("div",ue,[(0,n.Lk)("div",me,[t[6]||(t[6]=(0,n.Lk)("label",{class:"form-label"},"帳號",-1)),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>a.username=e),type:"text",class:"form-control",placeholder:"請輸入帳號"},null,512),[[o.Jo,a.username]])]),(0,n.Lk)("div",he,[t[7]||(t[7]=(0,n.Lk)("label",{class:"form-label"},"密碼",-1)),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>a.password=e),type:"password",class:"form-control",placeholder:"請輸入密碼"},null,512),[[o.Jo,a.password]])]),a.error?((0,n.uX)(),(0,n.CE)("div",pe,(0,u.v_)(a.error),1)):(0,n.Q3)("",!0),(0,n.Lk)("div",be,[(0,n.Lk)("button",{class:"btn btn-primary",onClick:t[3]||(t[3]=(...e)=>i.signup&&i.signup(...e))},"送出"),(0,n.Lk)("button",{class:"btn btn-secondary",onClick:t[4]||(t[4]=t=>e.$emit("close"))},"取消")])])])])])):(0,n.Q3)("",!0)}var ke={props:{show:{type:Boolean,required:!0}},data(){return{username:"",password:"",error:""}},methods:{signup(){this.error="",this.$emit("signup",{username:this.username,password:this.password}),this.username="",this.password=""}}};const ve=(0,i.A)(ke,[["render",ge],["__scopeId","data-v-6fc7b4ec"]]);var we=ve,Le={name:"NavBar",props:{title:{type:String,default:""}},components:{LoginModal:ne,SignUp:we},setup(){const e=(0,le.KR)(!1),t=(0,le.KR)(!1),s=J(),o=(0,c.rd)(),l=(0,c.lq)();(0,n.sV)((()=>{ae.A.get("/me",{withCredentials:!0}).then((e=>{e.data.success?s.login(e.data.username,e.data.role):s.logout()}))}));const a=({username:o,password:n})=>{ae.A.post("/login",{username:o,password:n},{withCredentials:!0}).then((o=>{o.data.success?(s.login(o.data.username,o.data.role),e.value=!1,t.value=!1,location.reload()):alert("帳號或密碼錯誤")}))},i=({username:e,password:t})=>{ae.A.post("/signup",{username:e,password:t},{withCredentials:!0}).then((e=>{e.data.success?(alert("註冊成功"),location.reload()):alert("帳號已存在")}))},d=()=>{ae.A.post("/logout",{},{withCredentials:!0}).then((()=>{s.logout(),l.path.startsWith("/admin")?o.push("/"):location.reload()}))};return{showLogin:e,showSignUp:t,userStore:s,handleSignUp:i,handleLogin:a,logout:d}}};const fe=(0,i.A)(Le,[["render",B],["__scopeId","data-v-231bce3c"]]);var ye=fe;const Ce={class:"chat-room-sidebar bg-dark text-white d-flex flex-column"},xe={class:"chat-header d-flex justify-content-between align-items-center p-2 border-bottom"},Pe={class:"mb-0"},_e={class:"flex-grow-1 overflow-auto p-2 border-bottom chat-messages",ref:"chatContainer"},Me={class:"avatar bg-success text-white rounded-circle d-flex justify-content-center align-items-center me-2",style:{width:"32px",height:"32px"}},Ae={class:"flex-grow-1"},Ue={class:"d-flex justify-content-between small text-muted"},Ee={class:"text-light"},Ne={style:{color:"#cccccc"}},Xe={class:"text-white"},Fe={class:"p-2 border-top"},Se={class:"input-group"};function $e(e,t,s,l,a,i){return(0,n.uX)(),(0,n.CE)("div",Ce,[(0,n.Lk)("div",xe,[(0,n.Lk)("h5",Pe,(0,u.v_)(s.mapName)+" 聊天室",1),(0,n.Lk)("button",{class:"btn btn-outline-light btn-sm",onClick:t[0]||(t[0]=t=>e.$emit("close"))},"隱藏聊天室")]),(0,n.Lk)("div",_e,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.messages,((e,t)=>((0,n.uX)(),(0,n.CE)("div",{key:t,class:"d-flex align-items-start mb-2",ref_for:!0,ref:t===a.messages.length-1?"lastMessage":null},[(0,n.Lk)("div",Me,(0,u.v_)(e.username.charAt(0).toUpperCase()),1),(0,n.Lk)("div",Ae,[(0,n.Lk)("div",Ue,[(0,n.Lk)("strong",Ee,(0,u.v_)(e.username),1),(0,n.Lk)("span",Ne,(0,u.v_)(i.formatTime(e.timestamp)),1)]),(0,n.Lk)("div",Xe,(0,u.v_)(e.message),1)])])))),128))],512),(0,n.Lk)("div",Fe,[(0,n.Lk)("div",Se,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>a.newMessage=e),onKeyup:t[2]||(t[2]=(0,o.jR)(((...e)=>i.sendMessage&&i.sendMessage(...e)),["enter"])),placeholder:"輸入訊息...",class:"form-control"},null,544),[[o.Jo,a.newMessage]]),(0,n.Lk)("button",{class:"btn btn-primary",onClick:t[3]||(t[3]=(...e)=>i.sendMessage&&i.sendMessage(...e))},"傳送")])])])}var Ie=s(4787),Te={props:{mapName:String,username:String},data(){return{socket:null,newMessage:"",messages:[],justSent:!1}},mounted(){this.socket=(0,Ie.io)(),this.socket.emit("join",{map:this.mapName}),this.socket.on("chat",(e=>{this.messages.push(e),this.justSent&&this.$nextTick((()=>{this.scrollToBottom()})),this.justSent=!1})),setTimeout((()=>this.scrollToBottom()),500),setTimeout((()=>this.scrollToBottom()),1500)},methods:{scrollToBottom(){this.$nextTick((()=>{setTimeout((()=>{requestAnimationFrame((()=>{const e=this.$refs.chatContainer;e&&(e.scrollTop=e.scrollHeight)}))}),300)}))},sendMessage(){this.newMessage.trim()&&(this.socket.emit("chat",{map:this.mapName,username:this.username,message:this.newMessage}),this.newMessage="",this.justSent=!0)},formatTime(e){const t=new Date(e);return t.toLocaleTimeString()}}};const je=(0,i.A)(Te,[["render",$e],["__scopeId","data-v-564da073"]]);var Ve=je,Re={components:{NavBar:ye,ChatRoom:Ve},props:["mapName"],data(){return{selectedGrenade:"",selectedPoint:null,selectedMethod:"",videoUrl:"",points:[],selectedMethodPanelVisible:!1,grenadeTypes:["smoke","flash","molotov"],tempxy:null,isAddP:!1,showAddPForm:!1,showAddForm:!1,showChat:!0,newMethodName:"",newMethodURL:""}},watch:{selectedGrenade(e){e?ae.A.get(`/maps/${this.mapName}/${e}/points`).then((e=>{this.points=e.data,this.selectedPoint=null,this.selectedMethod="",this.videoUrl="",this.tempxy=null,this.isAddP=!1,this.showAddPForm=!1,this.showAddForm=!1})).catch((e=>{console.error("載入點位失敗：",e)})):this.points=[]}},computed:{account_session(){const e=J();return e.isLoggedIn&&("admin"===e.role||"user"===e.role)},username(){return J().username}},methods:{selectUsagePoint(e){this.selectedPoint=e,this.selectedUsage="",this.videoUrl="",this.showAddForm=!1,this.showAddPForm=!1,this.newPostionName="",this.newMethodName="",this.newMethodURL="",this.isAddP=!1,this.selectedMethodPanelVisible=e.methods?.length>1,e.methods.length>1?(this.usages=e.methods,this.tempxy=null):1===e.methods.length&&(this.videoUrl=e.methods[0].video_url,this.tempxy=null)},isYoutube(e){return e.includes("youtube.com")||e.includes("youtu.be")},embedYoutube(e){if(e.includes("/shorts/")){const t=e.split("/shorts/")[1].split("?")[0];return`https://www.youtube.com/embed/${t}`}if(e.includes("watch?v=")){const t=e.split("watch?v=")[1].split("&")[0];return`https://www.youtube.com/embed/${t}`}if(e.includes("youtu.be/")){const t=e.split("youtu.be/")[1].split("?")[0];return`https://www.youtube.com/embed/${t}`}return""},fetchVideoFromPoint(){this.videoUrl=this.selectedMethod,this.selectedMethodPanelVisible=!1},submitNewMethod(){if(!this.newMethodName||!this.newMethodURL)return void alert("請填寫完整資訊");const e={map:this.mapName,grenade_type:this.selectedGrenade,point_name:this.selectedPoint.name,x:this.selectedPoint.x,y:this.selectedPoint.y,method:{name:this.newMethodName,video_url:this.newMethodURL}};ae.A.post("/submit_method",e).then((()=>{alert("送出成功，等待審核"),this.showAddForm=!1,this.newMethodName="",this.newMethodURL=""})).catch((e=>{console.error("送出失敗",e),alert("發生錯誤，請稍後再試")}))},MapClick(e){if(!this.isAddP)return;this.showAddForm=!1,this.showAddPForm=!0,this.videoUrl="";const t=e.target.getBoundingClientRect(),s=Math.round(e.clientX-t.left),o=Math.round(e.clientY-t.top);this.tempxy={x:s,y:o},this.selectedPoint=null},cancel_npm(){this.tempxy=null,this.showAddPForm=!1,this.isAddP=!1},submitNewPostionMethod(){if(!this.newPostionName||!this.newMethodName||!this.newMethodURL)return void alert("請填寫完整資訊");const{x:e,y:t}=this.tempxy,s={map:this.mapName,grenade_type:this.selectedGrenade,point_name:this.newPostionName,x:e,y:t,method:{name:this.newMethodName,video_url:this.newMethodURL}};ae.A.post("/submit_method",s).then((()=>{alert("送出成功，等待審核"),this.isAddP=!1,this.tempxy=null,this.showAddPForm=!1,this.newPostionName="",this.newMethodName="",this.newMethodURL=""})).catch((e=>{console.error("送出失敗",e),alert("發生錯誤，請稍後再試")}))}}};const Qe=(0,i.A)(Re,[["render",T],["__scopeId","data-v-56ed3ad4"]]);var Ke=Qe;const Be={class:"esports-bg text-white min-vh-100 py-5"},Oe={class:"container"},Je={class:"row g-4 mb-5"},Ye=["onClick"],ze=["src","alt"],Ge={class:"card-body text-center"},We={class:"card-title text-info"},De={key:0},qe={class:"row"},He=["onClick"],Ze=["src","alt"];function et(e,t,s,o,l,a){const i=(0,n.g2)("NavBar");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(i,{title:"選擇地圖"}),(0,n.Lk)("div",Be,[(0,n.Lk)("div",Oe,[t[2]||(t[2]=(0,n.Lk)("h4",{class:"mb-4 fw-bold text-info esports-title"},"🎮 選擇地圖",-1)),(0,n.Lk)("div",Je,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.maps,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e,class:"col-sm-6 col-md-4 col-lg-3"},[(0,n.Lk)("div",{class:"card esports-card text-center",onClick:t=>a.goToMap(e),style:{cursor:"pointer"}},[(0,n.Lk)("img",{src:`/cover/${e.toLowerCase()}.jpg`,class:"card-img-top",alt:e},null,8,ze),(0,n.Lk)("div",Ge,[(0,n.Lk)("h5",We,(0,u.v_)(e),1)])],8,Ye)])))),128))]),a.admin_session?((0,n.uX)(),(0,n.CE)("div",De,[t[1]||(t[1]=(0,n.Lk)("h5",{class:"text-danger fw-bold mb-3"},"👮 管理員專區",-1)),(0,n.Lk)("div",qe,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.adm,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e,class:"col-sm-6 col-md-4 col-lg-3"},[(0,n.Lk)("div",{class:"card esports-card text-center",onClick:t=>a.goToAdmin(e),style:{cursor:"pointer"}},[(0,n.Lk)("img",{src:`/cover/${e.toLowerCase()}.jpg`,class:"card-img-top",alt:e},null,8,Ze),t[0]||(t[0]=(0,n.Lk)("div",{class:"card-body text-center"},[(0,n.Lk)("h5",{class:"card-title fw-bold text-danger"},"待審核投擲")],-1))],8,He)])))),128))])])):(0,n.Q3)("",!0)])])],64)}var tt={components:{NavBar:ye},data(){return{maps:["Dust2","Mirage","Inferno","Anubis","Ancient","Nuke","Train"],adm:["admin"]}},computed:{admin_session(){const e=J();return e.isLoggedIn&&"admin"===e.role}},methods:{goToMap(e){this.$router.push(`/map/${e}`)},goToAdmin(){this.$router.push("/admin")}}};const st=(0,i.A)(tt,[["render",et],["__scopeId","data-v-b604ff06"]]);var ot=st;s(8111),s(1701);const nt={class:"detail-wrapper"},lt={key:0},at={key:1,class:"pending-table"},it=["onClick"],dt=["onClick"],rt={class:"pagination-controls"},ct=["disabled"],ut=["disabled"],mt={key:2,class:"preview-flex"},ht={class:"video-section"},pt={key:0},bt=["src"],gt={key:1},kt=["src"],vt={class:"map-section"},wt={class:"map-preview"},Lt=["src"],ft={key:3},yt={class:"info-block"},Ct={class:"actions"};function xt(e,t,s,l,a,i){const d=(0,n.g2)("NavBar");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(d,{title:"待審核投擲教學"}),(0,n.Lk)("div",nt,[0===a.pendingList.length?((0,n.uX)(),(0,n.CE)("div",lt,"目前沒有待審核的資料")):((0,n.uX)(),(0,n.CE)("table",at,[t[4]||(t[4]=(0,n.Lk)("thead",null,[(0,n.Lk)("tr",null,[(0,n.Lk)("th",null,"#"),(0,n.Lk)("th",null,"地圖"),(0,n.Lk)("th",null,"道具"),(0,n.Lk)("th",null,"點位"),(0,n.Lk)("th",null,"方法名稱")])],-1)),(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.pendingList,((e,t)=>((0,n.uX)(),(0,n.CE)("tr",{key:e.id,onClick:t=>i.selectItem(e.method.name),class:"table-row"},[(0,n.Lk)("td",null,(0,u.v_)((a.page-1)*a.pageSize+t+1),1),(0,n.Lk)("td",null,(0,u.v_)(e.map),1),(0,n.Lk)("td",null,(0,u.v_)(e.grenade_type),1),(0,n.Lk)("td",null,(0,u.v_)(e.point_name),1),(0,n.Lk)("td",null,[(0,n.Lk)("a",{href:"#",onClick:(0,o.D$)((t=>i.selectItem(e.method.name)),["prevent"])},(0,u.v_)(e.method.name),9,dt)])],8,it)))),128))])])),(0,n.Lk)("div",rt,[(0,n.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>i.prevPage&&i.prevPage(...e)),disabled:1===a.page},"上一頁",8,ct),(0,n.Lk)("span",null,"第 "+(0,u.v_)(a.page)+" 頁",1),(0,n.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>i.nextPage&&i.nextPage(...e)),disabled:a.page*a.pageSize>=a.total},"下一頁",8,ut)]),a.selected?((0,n.uX)(),(0,n.CE)("div",mt,[(0,n.Lk)("div",ht,[t[5]||(t[5]=(0,n.Lk)("h3",null,"影片預覽：",-1)),i.isYoutube(a.videoUrl)?((0,n.uX)(),(0,n.CE)("div",pt,[(0,n.Lk)("iframe",{width:"1080",height:"720",src:i.embedYoutube(a.videoUrl),frameborder:"0",allowfullscreen:""},null,8,bt)])):a.videoUrl?((0,n.uX)(),(0,n.CE)("div",gt,[(0,n.Lk)("video",{src:a.videoUrl,controls:"",width:"400"},null,8,kt)])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",vt,[t[6]||(t[6]=(0,n.Lk)("h4",null,"地圖與丟點預覽：",-1)),(0,n.Lk)("div",wt,[(0,n.Lk)("img",{src:`/maps/${a.selected.map.toLowerCase()}.png`,alt:"map"},null,8,Lt),(0,n.Lk)("div",{class:"red-dot",style:(0,u.Tr)({left:a.selected.x+"px",top:a.selected.y+"px"})},null,4)])])])):(0,n.Q3)("",!0),a.selected?((0,n.uX)(),(0,n.CE)("div",ft,[(0,n.Lk)("div",yt,[(0,n.Lk)("p",null,[t[7]||(t[7]=(0,n.Lk)("strong",null,"地圖：",-1)),(0,n.eW)((0,u.v_)(a.selected.map),1)]),(0,n.Lk)("p",null,[t[8]||(t[8]=(0,n.Lk)("strong",null,"道具：",-1)),(0,n.eW)((0,u.v_)(a.selected.grenade_type),1)]),(0,n.Lk)("p",null,[t[9]||(t[9]=(0,n.Lk)("strong",null,"點位：",-1)),(0,n.eW)((0,u.v_)(a.selected.point_name),1)]),(0,n.Lk)("p",null,[t[10]||(t[10]=(0,n.Lk)("strong",null,"方法名稱：",-1)),(0,n.eW)((0,u.v_)(a.selected.method.name),1)]),(0,n.Lk)("div",Ct,[(0,n.Lk)("button",{onClick:t[2]||(t[2]=e=>i.approve(a.selected.id))},"✅ 同意"),(0,n.Lk)("button",{onClick:t[3]||(t[3]=e=>i.reject(a.selected.id))},"❌ 拒絕")])])])):(0,n.Q3)("",!0)])],64)}s(2489);var Pt={components:{NavBar:ye},name:"AdminView",data(){return{pendingList:[],selected:null,page:1,pageSize:10,total:0,videoUrl:""}},created(){this.fetchPending()},methods:{fetchPending(){ae.A.get(`/pending_methods_paginated?page=${this.page}&size=${this.pageSize}`).then((e=>{this.pendingList=e.data.data,this.total=e.data.total}))},nextPage(){this.page*this.pageSize<this.total&&(this.page++,this.fetchPending())},prevPage(){this.page>1&&(this.page--,this.fetchPending())},selectItem(e){ae.A.get(`/get_single_pending/${e}`).then((e=>{this.videoUrl=e.data.method.video_url,this.selected=e.data})).catch((e=>{console.error("無法取得影片資訊：",e)}))},approve(e){ae.A.post(`/approve/${e}`).then((()=>{this.fetchPending(),this.removeItem(e)}))},reject(e){ae.A.post(`/reject/${e}`).then((()=>{this.fetchPending(),this.removeItem(e)}))},removeItem(e){this.pendingList=this.pendingList.filter((t=>t.id!==e)),this.selected=null},isYoutube(e){return e.includes("youtube.com")||e.includes("youtu.be")},embedYoutube(e){if(e.includes("/shorts/")){const t=e.split("/shorts/")[1].split("?")[0];return`https://www.youtube.com/embed/${t}`}if(e.includes("watch?v=")){const t=e.split("watch?v=")[1].split("&")[0];return`https://www.youtube.com/embed/${t}`}if(e.includes("youtu.be/")){const t=e.split("youtu.be/")[1].split("?")[0];return`https://www.youtube.com/embed/${t}`}return""}}};const _t=(0,i.A)(Pt,[["render",xt],["__scopeId","data-v-d69442e2"]]);var Mt=_t;const At=[{path:"/",name:"home",component:ot},{path:"/map/:mapName",name:"MapDetail",component:Ke,props:!0},{path:"/admin",name:"Admin",component:Mt}],Ut=(0,c.aE)({history:(0,c.LA)(),routes:At});var Et=Ut,Nt=s(2789);const Xt=(0,o.Ef)(r),Ft=(0,O.Ey)();Ft.use(Nt.A),Xt.use(Ft),Xt.use(Et),Xt.mount("#app")}},t={};function s(o){var n=t[o];if(void 0!==n)return n.exports;var l=t[o]={exports:{}};return e[o].call(l.exports,l,l.exports,s),l.exports}s.m=e,function(){var e=[];s.O=function(t,o,n,l){if(!o){var a=1/0;for(c=0;c<e.length;c++){o=e[c][0],n=e[c][1],l=e[c][2];for(var i=!0,d=0;d<o.length;d++)(!1&l||a>=l)&&Object.keys(s.O).every((function(e){return s.O[e](o[d])}))?o.splice(d--,1):(i=!1,l<a&&(a=l));if(i){e.splice(c--,1);var r=n();void 0!==r&&(t=r)}}return t}l=l||0;for(var c=e.length;c>0&&e[c-1][2]>l;c--)e[c]=e[c-1];e[c]=[o,n,l]}}(),function(){s.d=function(e,t){for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,o){var n,l,a=o[0],i=o[1],d=o[2],r=0;if(a.some((function(t){return 0!==e[t]}))){for(n in i)s.o(i,n)&&(s.m[n]=i[n]);if(d)var c=d(s)}for(t&&t(o);r<a.length;r++)l=a[r],s.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return s.O(c)},o=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=s.O(void 0,[504],(function(){return s(2323)}));o=s.O(o)})();
//# sourceMappingURL=app.c912d52b.js.map